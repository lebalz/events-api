datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
}

model User {
    id         String   @id @default(uuid())
    email      String   @unique
    untisId    Int?     @unique
    shortName  String?  @unique
    firstName  String
    lastName   String
    role       Role     @default(USER)
    createdAt  DateTime @default(now())
    updatedAt  DateTime @updatedAt
    events     Event[]  @relation("events")

    responsibleFor Event[] @relation("responsibleFor")
}

model Event {
    id              String         @id @default(uuid())
    author          User           @relation("events", fields: [authorId], references: [id])
    authorId        String
    start           DateTime
    end             DateTime
    allDay          Boolean
    location        String
    description     String
    descriptionLong String
    departements    Departements[] @default([])
    classes         String[]       @default([])
    createdAt       DateTime       @default(now())
    updatedAt       DateTime       @default(now()) @updatedAt
    state           EventState     @default(DRAFT)
    onlyKLP         Boolean        @default(false)

    responsible User[] @relation("responsibleFor")
}

enum Role {
    STUDENT
    USER
    ADMIN
}

enum Departements {
    GYM
    FMS
    WMS
}

enum EventState {
    DRAFT
    REVIEW
    PUBLISHED
    DELETED
}
